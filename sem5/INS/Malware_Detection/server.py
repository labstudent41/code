import socket
import ssl

port = 8888
threat_signatures = ['malware', 'exploit', 'ranjit', 'attack']
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
sock.bind(('127.0.0.1', port))
sock.listen(5)
print("Server listening at http://127.0.0.1:%d" %port)

while True:
    try:
        clientsock, clientaddr = sock.accept()
        response = clientsock.recv(1024).decode()
        print("\n:: Recieved message from", clientaddr)
        print(response)

        for signature in threat_signatures:
            if signature in response.lower():
                print("\n!! OH MY GOSH! DANGER! !!")
                print("Attack from client.")
                print("Detected %s in response" %signature)
                print("Shutting Down...")
                clientsock.send(b"Intrusion Detected.")
                clientsock.close()
                exit()

        clientsock.send(b"Welcome to the server.")
        clientsock.close()

    except KeyboardInterrupt:
        print("Exiting server...")
        exit()
    except Exception as e:
        print("SERVER_ERROR:", e)

